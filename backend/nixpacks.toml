[phases.setup]
nixPkgs = ["nodejs-18_x", "python310", "python310Packages.pip", "python310Packages.setuptools", "python310Packages.wheel"]

[phases.install]
cmds = [
  "npm install",
  "python3 -m pip install --user --upgrade pip setuptools wheel",
  "export PATH=$HOME/.local/bin:$PATH",
  "python3 -m pip install --user --no-cache-dir -r requirements-core.txt",
  "python3 -m pip install --user --no-cache-dir -r requirements-ml.txt || python3 -m pip install --user --no-cache-dir tensorflow-cpu>=2.10.0 opencv-python-headless>=4.6.0"
]

[start]
cmd = "export PATH=$HOME/.local/bin:$PATH && node server.js"

